<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n tr·ªã H·ªá th·ªëng tr√¥ng xe</title>
    
    <!-- Fonts & Libraries -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>

    <!-- Config Files -->
    <link rel="stylesheet" href="admin.css">
    <script src="config.js"></script>

</head>
<body>
    <!-- ================================================================= -->
    <!-- M√ÄN H√åNH ƒêƒÇNG NH·∫¨P -->
    <!-- ================================================================= -->
    <div id="login-screen">
        <div class="login-card">
            <h2>ƒêƒÉng nh·∫≠p Qu·∫£n tr·ªã</h2>
            <form id="login-form">
                <div class="form-group" style="margin-bottom: 1rem;">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">M·∫≠t kh·∫©u</label>
                    <input type="password" id="login-password" required>
                </div>
                <p id="login-error-message"></p>
                <button type="submit" class="action-button btn-primary" style="width: 100%; margin-top: 1.5rem;">ƒêƒÉng nh·∫≠p</button>
            </form>
        </div>
    </div>

    <!-- ================================================================= -->
    <!-- N·ªòI DUNG CH√çNH (·∫®N M·∫∂C ƒê·ªäNH) -->
    <!-- ================================================================= -->
    <div id="main-admin-content" style="display: none; width: 100%; height: 100vh;">
        <div class="sidebar">
            <div class="sidebar-header">
                <img src="https://cdn.haitrieu.com/wp-content/uploads/2021/11/Logo-Doan-Thanh-NIen-Cong-San-Ho-Chi-Minh-1.png" alt="Logo">
                <h2>Qu·∫£n tr·ªã</h2>
            </div>
            <nav class="nav-menu">
                <ul>
                    <li><a href="index.html" title="Quay v·ªÅ trang ƒëi·ªÅu h√†nh ch√≠nh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg><span>B·∫£ng ƒëi·ªÅu h√†nh</span></a></li>
                    <li><a href="#" class="nav-link active" data-target="page-dashboard"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18"/><path d="M18.7 8a2 2 0 0 1 0 2.8l-6 6-3.4-3.4-3-3a2 2 0 0 1 0-2.8l6-6a2 2 0 0 1 2.8 0z"/></svg><span>T·ªïng quan</span></a></li>
                    <li><a href="#" class="nav-link" data-target="page-transactions"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/><path d="m15 5 3 3"/></svg><span>Giao d·ªãch</span></a></li>
                    <li><a href="#" class="nav-link" data-target="page-locations"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-10a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg><span>Qu·∫£n l√Ω V·ªã tr√≠</span></a></li>
                    <li><a href="#" class="nav-link" data-target="page-security"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg><span>An ninh</span></a></li>
                    <li><a href="#" class="nav-link" data-target="page-staff"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg><span>Nh√¢n s·ª±</span></a></li>
                </ul>
            </nav>
        </div>
        <!-- L·ªõp ph·ªß ƒë·ªÉ ƒë√≥ng menu tr√™n di ƒë·ªông -->
        <div class="sidebar-overlay"></div>

        <main class="main-content">
            <!-- THANH ƒêI·ªÄU H∆Ø·ªöNG TR√äN (TOP BAR) -->
            <header class="top-bar">
                <div class="page-header">
                    <!-- N√∫t Hamburger Menu cho di ƒë·ªông -->
                    <button id="menu-toggle-btn" class="menu-toggle-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                    </button>
                    <h1 id="page-title">T·ªïng quan h·ªá th·ªëng</h1>
                    <p id="page-description">Th·ªëng k√™ v√† bi·ªÉu ƒë·ªì tr·ª±c quan v·ªÅ ho·∫°t ƒë·ªông trong ng√†y.</p>
                </div>
                <div class="top-bar-actions">
                    <button id="logout-btn" class="action-button btn-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>ƒêƒÉng xu·∫•t</button>
                </div>
            </header>

            <!-- PAGE: T·ªîNG QUAN -->
            <div id="page-dashboard" class="page-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon revenue"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="1" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
                        <div class="stat-info">
                            <h3>Doanh thu</h3>
                            <p id="total-revenue">0 <sup>ƒë</sup></p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon vehicles"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 16.5V14a2 2 0 0 0-2-2h-1a2 2 0 0 0-2 2v2.5"/><path d="M12 12V8"/><circle cx="12" cy="6" r="2"/><path d="M15 20a2 2 0 0 0 2-2V9.5a2.5 2.5 0 0 0-2.5-2.5h-5A2.5 2.5 0 0 0 7 9.5V18a2 2 0 0 0 2 2h6Z"/></svg></div>
                        <div class="stat-info">
                            <h3>T·ªïng l∆∞·ª£t xe</h3>
                            <p id="total-vehicles">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon parking"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/></svg></div>
                        <div class="stat-info">
                            <h3>Xe ƒëang g·ª≠i</h3>
                            <p id="current-vehicles">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg></div>
                        <div class="stat-info">
                            <h3>Ch·ªçn ng√†y</h3>
                            <input type="date" id="admin-date-picker">
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header"><h3>L∆∞u l∆∞·ª£ng xe theo gi·ªù</h3></div>
                    <div class="card-body"><div class="chart-container"><canvas id="traffic-chart"></canvas></div></div>
                </div>

                <div class="chart-grid">
                    <div class="card">
                        <div class="card-header"><h3 id="revenue-chart-title">Doanh thu theo b√£i ƒë·ªó xe</h3></div>
                        <div class="card-body"><div class="chart-container"><canvas id="revenue-chart"></canvas></div></div>
                    </div>
                    <div class="card">
                        <div class="card-header"><h3 id="vehicles-chart-title">L∆∞·ª£t xe theo b√£i ƒë·ªó xe</h3></div>
                        <div class="card-body"><div class="chart-container"><canvas id="vehicles-chart"></canvas></div></div>
                    </div>
                </div>
            </div>

            <!-- PAGE: GIAO D·ªäCH -->
            <div id="page-transactions" class="page-content">
                <div class="card">
                    <div class="card-header">
                        <h3>T·∫•t c·∫£ Giao d·ªãch</h3>
                        <div id="transaction-search-wrapper" class="search-input-wrapper">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                            <input type="text" id="transaction-search-input" placeholder="T√¨m theo Bi·ªÉn s·ªë, ID, SƒêT...">
                            <div class="scanner-line"></div>
                            <svg id="transaction-scan-qr-btn" class="action-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" title="Qu√©t m√£ QR ƒë·ªÉ t√¨m giao d·ªãch"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"/></svg>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-wrapper">
                            <table>
                                <thead><tr><th>Bi·ªÉn s·ªë</th><th>Gi·ªù v√†o</th><th>Gi·ªù ra</th><th>Ph√≠</th><th>Thanh to√°n</th><th>B√£i ƒë·ªó xe</th><th style="text-align: center;">Tr·∫°ng th√°i</th><th style="text-align: center;">H√†nh ƒë·ªông</th></tr></thead>
                                <tbody id="transaction-log-body"></tbody>
                            </table>
                        </div>
                        <div id="pagination-controls"></div>
                    </div>
                </div>
            </div>

            <!-- PAGE: QU·∫¢N L√ù V·ªä TR√ç -->
            <div id="page-locations" class="page-content">
                <div class="locations-grid-layout">
                    <div class="card" style="height: calc(100vh - 12rem);">
                        <div class="card-header">
                            <h3>B·∫£n ƒë·ªì c√°c ƒëi·ªÉm tr√¥ng gi·ªØ xe</h3>
                            <button id="reset-filter-btn" class="action-button btn-secondary" style="display: none; width: auto; padding: 5px 12px; font-size: 0.9rem;">B·ªè l·ªçc</button>
                        </div>
                        <div class="card-body" style="height: calc(100% - 60px);"><div id="map-container" style="width: 100%; height: 100%; border-radius: var(--border-radius-md);"></div></div>
                    </div>
                    <div class="card" style="height: calc(100vh - 12rem); display: flex; flex-direction: column;">
                        <div class="card-header">
                            <h3>Danh s√°ch B√£i ƒë·ªó xe</h3>
                            <button id="add-location-btn" class="action-button btn-primary">Th√™m B√£i ƒë·ªó m·ªõi</button>
                        </div>
                        <div class="card-body" style="flex-grow: 1; overflow-y: auto;">
                            <div class="table-wrapper">
                                <table>
                                    <thead><tr><th>M√£ (ID)</th><th>T√™n B√£i ƒë·ªó</th><th>ƒê·ªãa ch·ªâ</th><th>H√†nh ƒë·ªông</th></tr></thead>
                                    <tbody id="locations-table-body"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PAGE: AN NINH -->
            <div id="page-security" class="page-content">
                <div class="security-layout-grid" style="align-items: start;">
                    <div class="card">
                        <div class="card-header"><h3>G·ª≠i C·∫£nh b√°o An ninh</h3></div>
                        <div class="card-body">
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label for="security-alert-plate">Bi·ªÉn s·ªë xe c·∫ßn c·∫£nh b√°o</label>
                                <input type="text" id="security-alert-plate" placeholder="V√≠ d·ª•: 29A12345">
                            </div>
                            <div class="form-group" style="margin-bottom: 1rem;">
                                <label for="security-alert-reason">L√Ω do c·∫£nh b√°o</label>
                                <textarea id="security-alert-reason" placeholder="V√≠ d·ª•: Xe nghi v·∫•n, b√°o m·∫•t c·∫Øp..." rows="3" style="resize: vertical;"></textarea>
                            </div>
                            <div id="default-reasons-container" style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 1.5rem;">
                                <button type="button" class="default-reason-btn">Xe nghi v·∫•n</button>
                                <button type="button" class="default-reason-btn">B√°o m·∫•t c·∫Øp</button>
                                <button type="button" class="default-reason-btn">Y√™u c·∫ßu gi·ªØ l·∫°i</button>
                            </div>
                            <div id="alert-level-container" style="display: flex; flex-direction: column; gap: 1rem; margin-bottom: 1.5rem;">
                                <label style="cursor: pointer; display: flex; align-items: center; gap: 8px;"><input type="radio" name="alert-level" value="warning" checked> <strong>C·∫£nh b√°o</strong> (Hi·ªÉn th·ªã th√¥ng b√°o)</label>
                                <label style="cursor: pointer; display: flex; align-items: center; gap: 8px; color: var(--danger-color);"><input type="radio" name="alert-level" value="block"> <strong>Ch·∫∑n L·∫•y Xe</strong> (Kh√¥ng cho ph√©p checkout)</label>
                            </div>
                            <div style="display: flex; gap: 1rem;">
                                <button id="remove-alert-btn" class="action-button btn-secondary" style="flex-grow: 1;">G·ª° C·∫£nh b√°o</button>
                                <button id="send-security-alert-btn" class="action-button btn-danger" style="flex-grow: 1;">G·ª≠i C·∫£nh B√°o</button>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header"><h3><span style="color: var(--danger-color);">üö®</span> Gi√°m s√°t C·∫£nh b√°o</h3></div>
                        <div class="card-body" style="padding: 0; max-height: 500px; overflow-y: auto;">
                            <div id="active-alerts-list"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PAGE: QU·∫¢N L√ù NH√ÇN S·ª∞ -->
            <div id="page-staff" class="page-content">
                <div class="card">
                    <div class="card-header">
                        <h3>Qu·∫£n l√Ω Nh√¢n s·ª± T·∫°m th·ªùi</h3>
                        <button id="add-staff-btn" class="action-button btn-primary">Th√™m Nh√¢n vi√™n</button>
                    </div>
                    <div class="card-body">
                        <p class="page-description" style="margin-bottom: 1.5rem;">T·∫°o v√† qu·∫£n l√Ω t√†i kho·∫£n ƒëƒÉng nh·∫≠p cho nh√¢n vi√™n t·∫°m th·ªùi (T√¨nh nguy·ªán vi√™n). C√°c t√†i kho·∫£n n√†y ch·ªâ c√≥ th·ªÉ truy c·∫≠p B·∫£ng ƒëi·ªÅu h√†nh ch√≠nh.</p>
                        <div class="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>T√™n ƒëƒÉng nh·∫≠p</th>
                                        <th>H·ªç v√† T√™n</th>
                                        <th>B√£i ƒë·ªó ƒë∆∞·ª£c ph√¢n c√¥ng</th>
                                        <th>H√†nh ƒë·ªông</th>
                                    </tr>
                                </thead>
                                <tbody id="staff-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ================================================================= -->
    <!-- MODALS -->
    <!-- ================================================================= -->
    <!-- MODAL: CH·ªàNH S·ª¨A GIAO D·ªäCH (THI·∫æT K·∫æ L·∫†I) -->
    <div id="transaction-modal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="transaction-modal-title">Ch·ªânh s·ª≠a Giao d·ªãch</h2>
                <button id="close-transaction-modal-btn" class="close-btn" title="ƒê√≥ng">&times;</button>
            </div>
            <div class="modal-body">
                <form id="transaction-form">
                    <input type="hidden" id="transaction-unique-id">
                    <div class="form-grid">
                        <div class="form-group"><label for="transaction-plate">Bi·ªÉn s·ªë xe</label><input type="text" id="transaction-plate" required></div>
                        <div class="form-group"><label for="transaction-fee">Ph√≠ (VNƒê)</label><input type="number" id="transaction-fee"></div>
                        <div class="form-group"><label for="transaction-entry-time">Gi·ªù v√†o</label><input type="datetime-local" id="transaction-entry-time"></div>
                        <div class="form-group"><label for="transaction-exit-time">Gi·ªù ra</label><input type="datetime-local" id="transaction-exit-time"></div>
                        <div class="form-group"><label for="transaction-payment-method">Ph∆∞∆°ng th·ª©c TT</label>
                            <select id="transaction-payment-method">
                                <option value="">Ch∆∞a ch·ªçn</option>
                                <option value="Ti·ªÅn m·∫∑t">Ti·ªÅn m·∫∑t</option>
                                <option value="Chuy·ªÉn kho·∫£n QR">Chuy·ªÉn kho·∫£n QR</option>
                                <option value="Mi·ªÖn ph√≠">Mi·ªÖn ph√≠</option>
                                <option value="VIP">VIP</option>
                            </select>
                        </div>
                        <div class="form-group"><label for="transaction-status">Tr·∫°ng th√°i</label>
                            <select id="transaction-status">
                                <option value="ƒêang g·ª≠i">ƒêang g·ª≠i</option>
                                <option value="ƒê√£ r·ªùi b√£i">ƒê√£ r·ªùi b√£i</option>
                            </select>
                        </div>
                        <div class="form-group" style="grid-column: 1 / -1;">
                            <label for="transaction-notes">Ghi ch√∫</label><textarea id="transaction-notes" rows="3"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="delete-transaction-btn" class="action-button btn-danger" style="margin-right: auto;">X√≥a Giao d·ªãch</button>
                <button type="button" id="cancel-transaction-btn" class="action-button btn-secondary">H·ªßy</button>
                <button type="button" id="save-transaction-btn" class="action-button btn-primary">L∆∞u thay ƒë·ªïi</button>
            </div>
        </div>
    </div>

    <div id="location-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2 id="location-modal-title">Th√™m B√£i ƒë·ªó xe m·ªõi</h2><button id="close-location-modal-btn" class="close-btn" title="ƒê√≥ng">&times;</button></div>
            <div class="modal-body">
                <form id="location-form">
                    <div class="form-grid">
                        <div class="form-group"><label for="location-id">M√£ (ID)</label><input type="text" id="location-id" required placeholder="VIETLIEN, KHONGDAU"></div>
                        <div class="form-group"><label for="location-name">T√™n B√£i ƒë·ªó</label><input type="text" id="location-name" required></div>
                        <div class="form-group"><label for="location-lat">Vƒ© ƒë·ªô (Latitude)</label><input type="number" step="any" id="location-lat" required></div>
                        <div class="form-group"><label for="location-lng">Kinh ƒë·ªô (Longitude)</label><input type="number" step="any" id="location-lng" required></div>
                    </div>
                    <div class="form-group" style="margin-top: 1.25rem;"><label for="location-address">ƒê·ªãa ch·ªâ</label><input type="text" id="location-address"></div>
                    <div class="form-grid" style="margin-top: 1.25rem;">
                        <div class="form-group"><label for="location-capacity">S·ª©c ch·ª©a</label><input type="number" id="location-capacity"></div>
                        <div class="form-group"><label for="location-hotline">Hotline</label><input type="text" id="location-hotline"></div>
                    </div>
                    <div class="form-group" style="margin-top: 1.25rem;">
                        <label for="location-operating-hours">Gi·ªù ho·∫°t ƒë·ªông</label>
                        <input type="text" id="location-operating-hours" placeholder="V√≠ d·ª•: 08:00 ‚Äì 22:00">
                    </div>
                    <div class="form-group" style="margin-top: 1.25rem;">
                        <label for="location-event-name">T√™n s·ª± ki·ªán (n·∫øu c√≥)</label>
                        <input type="text" id="location-event-name" placeholder="V√≠ d·ª•: L·ªÖ h·ªôi √Åo d√†i 2025">
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1; margin-top: 1.25rem;">
                        <label for="location-fee-policy-type">Lo·∫°i h√¨nh thu ph√≠</label>
                        <select id="location-fee-policy-type">
                            <option value="free">Mi·ªÖn ph√≠</option>
                            <option value="hourly">Thu ph√≠ theo gi·ªù</option>
                            <option value="per_entry">Thu ph√≠ theo l∆∞·ª£t</option>
                            <option value="daily">Thu ph√≠ theo ng√†y</option>
                        </select>
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label for="location-fee-collection-policy">Th·ªùi ƒëi·ªÉm thu ph√≠</label>
                        <select id="location-fee-collection-policy">
                            <option value="post_paid">Thu ph√≠ khi xe ra (M·∫∑c ƒë·ªãnh)</option>
                            <option value="pre_paid">Thu ph√≠ ngay khi xe v√†o</option>
                        </select>
                        <small style="margin-top: 5px; color: var(--text-secondary);">L∆∞u √Ω: "Thu ph√≠ khi v√†o" ch·ªâ √°p d·ª•ng cho lo·∫°i h√¨nh "Theo l∆∞·ª£t" ho·∫∑c "Theo ng√†y".</small>
                    </div>
                    <div id="custom-fee-inputs-wrapper" class="custom-fee-inputs-wrapper" style="grid-column: 1 / -1; margin-top: 1.25rem; border-top: 1px solid var(--border-color-light); padding-top: 1.25rem;">
                        <div class="fee-input-group" data-policy="hourly" style="display: none;">
                            <div class="form-group">
                            <label for="location-fee-hourly-day">Ph√≠ gi·ªù ban ng√†y (ƒë/h)</label>
                            <input type="number" id="location-fee-hourly-day" placeholder="M·∫∑c ƒë·ªãnh: 5,000">
                            </div>
                            <div class="form-group">
                            <label for="location-fee-hourly-night">Ph√≠ gi·ªù ban ƒë√™m (ƒë/h)</label>
                            <input type="number" id="location-fee-hourly-night" placeholder="M·∫∑c ƒë·ªãnh: 8,000">
                            </div>
                        </div>
                        <div class="fee-input-group" data-policy="per_entry" style="display: none;">
                            <div class="form-group">
                                <label for="location-fee-per-entry">Ph√≠ m·ªói l∆∞·ª£t</label>
                                <input type="number" id="location-fee-per-entry" placeholder="M·∫∑c ƒë·ªãnh: 10,000">
                            </div>
                        </div>
                        <div class="fee-input-group" data-policy="daily" style="display: none;">
                            <div class="form-group">
                                <label for="location-fee-daily">Ph√≠ m·ªói ng√†y</label>
                                <input type="number" id="location-fee-daily" placeholder="M·∫∑c ƒë·ªãnh: 30,000">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="delete-location-btn" class="action-button btn-danger" style="margin-right: auto; display: none;">X√≥a</button>
                <button type="button" id="cancel-location-btn" class="action-button btn-secondary">H·ªßy</button>
                <button type="button" id="save-location-btn" class="action-button btn-primary">L∆∞u</button>
            </div>
        </div>
    </div>

    <!-- MODAL: TH√äM/S·ª¨A NH√ÇN VI√äN -->
    <div id="staff-modal" class="modal">
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2 id="staff-modal-title">Th√™m Nh√¢n vi√™n m·ªõi</h2>
                <button id="close-staff-modal-btn" class="close-btn" title="ƒê√≥ng">&times;</button>
            </div>
            <div class="modal-body">
                <form id="staff-form">
                    <input type="hidden" id="staff-id">
                    <div class="form-group" style="margin-bottom: 1.25rem;"><label for="staff-username">T√™n ƒëƒÉng nh·∫≠p (kh√¥ng d·∫•u, kh√¥ng c√°ch)</label><input type="text" id="staff-username" required></div>
                    <div class="form-group" style="margin-bottom: 1.25rem;"><label for="staff-pin">M√£ PIN (4-6 ch·ªØ s·ªë)</label><input type="password" id="staff-pin" required pattern="\d{4,6}" title="M√£ PIN ph·∫£i l√† 4 ƒë·∫øn 6 ch·ªØ s·ªë."></div>
                    <div class="form-group" style="margin-bottom: 1.25rem;"><label for="staff-fullname">H·ªç v√† T√™n</label><input type="text" id="staff-fullname" required></div>
                    <div class="form-group"><label for="staff-location-assignment">Ph√¢n c√¥ng cho B√£i ƒë·ªó</label><select id="staff-location-assignment" required></select></div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="delete-staff-btn" class="action-button btn-danger" style="margin-right: auto; display: none;">X√≥a</button>
                <button type="button" id="cancel-staff-btn" class="action-button btn-secondary">H·ªßy</button>
                <button type="button" id="save-staff-btn" class="action-button btn-primary">L∆∞u</button>
            </div>
        </div>
    </div>

    <div id="admin-qr-scanner-modal" class="modal">
        <div class="modal-content" style="max-width: 480px;">
            <div class="modal-header"><h2>Qu√©t m√£ QR</h2><button id="close-admin-scanner-btn" class="close-btn" title="ƒê√≥ng">&times;</button></div>
            <div class="modal-body">
                <video id="admin-camera-feed"></video>
                <div class="scanner-overlay">
                    <div class="scanner-viewfinder">
                        <div class="corner corner-tl"></div><div class="corner corner-tr"></div><div class="corner corner-bl"></div><div class="corner corner-br"></div>
                    </div>
                </div>
                <div id="admin-scan-feedback">
                    <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg>
                </div> 
            </div>
        </div>
    </div>

    <div id="toast-container"></div>

    <script src="admin.js"></script>
</body>
</html>
